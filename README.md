# Проект: Рекомендательная система постов в социальной сети
## Описание проекта

Проект посвящен разработке модели рекомендаций для соцсети, которая будет показывать посты, потенциально интересные пользователю, в его ленте. Основной целью данной части проекта является создание алгоритма, который будет предлагать посты так, чтобы максимизировать метрику hitrate@5.

### Задачи проекта
1. Изучить и проанализировать предоставленные данные.
2. Создать и обработать признаки для построения модели.
3. Разработать и обучить несколько моделей машинного обучения.
4. Оценить качество моделей по метрике hitrate@5.
5. Выбрать наилучшую модель для реализации.

### Описание данных
1. **Таблица `user_data`** - Информация о пользователях соцсети:
   - `age`: Возраст пользователя
   - `city`: Город пользователя
   - `country`: Страна пользователя
   - `exp_group`: Экспериментальная группа
   - `gender`: Пол пользователя
   - `user_id`: Уникальный идентификатор пользователя
   - `os`: Операционная система устройства
   - `source`: Источник трафика (органический или реклама)

2. **Таблица `post_text_df`** - Информация о постах:
   - `id`: Уникальный идентификатор поста
   - `text`: Текстовое содержание поста
   - `topic`: Тематика поста

3. **Таблица `feed_data`** - История просмотра постов пользователями:
   - `timestamp`: Время просмотра
   - `user_id`: Идентификатор пользователя
   - `post_id`: Идентификатор поста
   - `action`: Тип действия (просмотр или лайк)
   - `target`: 1 если после просмотра был лайк, иначе 0

### Этапы проекта
1. **Загрузка данных и предварительная обработка**:
   - Загрузка необходимых библиотек и инструментов.
   - Импорт данных из базы данных.
   - Проведение предварительного анализа данных (EDA).

2. **Создание признаков**:
   - Предобработка текстов постов (токенизация, лемматизация, удаление стоп-слов).
   - Создание TF-IDF матрицы для текстов постов.
   - Кластеризация постов на основе TF-IDF признаков.
   - Создание дополнительных признаков для пользователей (например, отношение взаимодействия с кластерами постов).

3. **Подготовка данных для обучения модели**:
   - Разделение данных на обучающую и тестовую выборки.
   - Объединение данных о пользователях и постах с основной таблицей взаимодействий.
   - Кодирование категориальных признаков и нормализация числовых признаков.

4. **Тренировка моделей и оценка их качества**:
   - Обучение моделей логистической регрессии, CatBoost и нейронной сети.
   - Оценка качества моделей по метрикам точности, ROC AUC и hitrate@5.

5. **Анализ результатов**:
   - Сравнение моделей по основным метрикам.
   - Выводы о качестве моделей и рекомендации по их улучшению.

### Выводы
- **Логистическая регрессия** показала низкое качество предсказаний для класса 1 и низкий ROC AUC.
- **CatBoost** продемонстрировал улучшенные результаты по сравнению с логистической регрессией, особенно по метрике ROC AUC.
- **Сбалансированная нейронная сеть** показала наилучший результат по метрике hitrate@5, а также хорошие результаты по другим метрикам.

CatBoost и нейронная сеть оказались лучшими моделями, однако нейронная сеть показала наиболее высокий hitrate@5, что делает ее предпочтительной для дальнейшего использования и улучшения.

### Использованные библиотеки и инструменты
- **Библиотеки для работы с данными**: pandas, numpy
- **Визуализация данных**: matplotlib, seaborn
- **Обработка текстов**: nltk, re
- **Машинное обучение**: sklearn, catboost, tensorflow, keras
- **Базы данных**: psycopg2, sqlalchemy
- **Прочее**: imblearn, tqdm, statsmodels

Проект предоставил ценные инсайты для разработки системы рекомендаций и показал возможности различных моделей в улучшении качества предсказаний.
